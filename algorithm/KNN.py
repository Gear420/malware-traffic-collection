from sklearn.model_selection import train_test_split  #建立模型前，需要将数据分为测试集和训练集
from sklearn.neighbors import KNeighborsClassifier



import pandas as pd
data = pd.read_csv("../train_tcp.csv", sep='\t', header=None)
labels = data.iloc[:, -1]
import numpy as np
labels = np.array(labels)
labels = labels.tolist()
print(labels)



X = []
for index in range(len(labels)):
	t = data.iloc[index][:-1]
	t = np.array(t)
	t = t.tolist()
	X.append(t)
def predict(x_test,y_test):
	predict = knn.predict(x_test)
	i = 0
	for index in range(len(x_test)):
		if predict[index] == y_test[index]:
			i = i+1
		else:
			continue
	print('Accuracy: {:.5f}%'.format(100 * i / len(x_test)))
	

X_train,X_test,y_train,y_test=train_test_split(X,labels,test_size=0.2)



knn = KNeighborsClassifier()
knn.fit(X_train, y_train)

predict(X_test,y_test)




